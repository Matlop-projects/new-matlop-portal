<div class="container mt-3 mb-3">
  <form [formGroup]="form" class="mt-5 mb-5" (ngSubmit)="onSubmit()">
    <div class="d-flex justify-content-between flex-wrap w-100">
      <div class="w-49">
        <p-floatlabel variant="on">
          <p-select
            class="w-100"
            (onChange)="onCountrySelect($event.value)"
            [options]="countryList"
            formControlName="countryId"
            optionValue="code"
            optionLabel="name"
          />
          <label for="on_label">{{
            "location.country_name" | translate
          }}</label>
        </p-floatlabel>
      </div>
      <div class="w-49">
        <p-floatlabel variant="on">
          <p-select
            class="w-100"
            (onChange)="onCitySelect($event.value)"
            [options]="cityList"
            formControlName="cityId"
            optionValue="code"
            optionLabel="name"
          />
          <label for="on_label"> {{ "location.city_name" | translate }}</label>
        </p-floatlabel>
      </div>
      <div class="w-49">
        <p-floatlabel variant="on">
          <p-select
            class="w-100"
            [options]="districtList"
            formControlName="districtId"
            optionValue="code"
            optionLabel="name"
          />
          <label for="on_label">
            {{ "location.sector_name" | translate }}</label
          >
        </p-floatlabel>
      </div>
      <div class="w-49">
        <p-floatlabel variant="on">
          <input
            class="w-100"
            pInputText
            id="on_label"
            formControlName="blockNo"
            autocomplete="off"
          />
          <label for="on_label"> {{ "location.block_name" | translate }}</label>
        </p-floatlabel>
      </div>
    </div>
    
    <!-- Map Component Section -->
    <div class="map-container mt-4 mb-4">
      <h5 class="mb-3">{{ "location.select_location_on_map" | translate }}</h5>
      <div class="map-wrapper" style="height: 400px; border: 1px solid #ddd; border-radius: 8px; overflow: hidden;">
        <app-map 
          [lat]="form.get('latitude')?.value || 0" 
          [lng]="form.get('longitude')?.value || 0"
          (location)="onLocationChange($event)">
        </app-map>
      </div>
      <div class="coordinates-display mt-2" *ngIf="form.get('latitude')?.value && form.get('longitude')?.value">
        <small class="text-muted">
          {{ "location.coordinates" | translate }}: 
          {{ form.get('latitude')?.value | number:'1.6-6' }}, 
          {{ form.get('longitude')?.value | number:'1.6-6' }}
        </small>
      </div>
    </div>
    
    <div class="buttons mt-4 mb-4">
      <button
        class="btn submit"
        type="submit"
        [class.not-allowed]="!form.valid"
        [disabled]="!form.valid"
      >
        <span>{{ "location.add_location" |translate}}</span>
      </button>
    </div>
  </form>
</div>
